<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	layout:decorate="~{management/template}">
<head>
<title>List of products</title>
<link th:href="@{/assets/data-tables/datatables.min.css}" rel="stylesheet"/>	
</head>
<body>
	<div layout:fragment="content">
		<div class="row">
               <div class="col-sm-12">
               	<h2><i class="fas fa-home"></i><span class="pl-3">Products Management</span></h2>
               	<hr class="mb-3">
               </div>
         </div>
         
         <div class="row">
                
                <div class="col-sm-12">
                    <div class="card mb-5">
                        <div class="card-body">
                            <div class="action-buttons">
	                            <a href="#" class="btn btn-info" data-toggle="modal" data-target="#new-product-form"><i class="fas fa-list"></i><span class="pl-3">Add Product</span></a>
	                            
	                            <div class="btn-group">
							  		
							  		<button type="button" class="btn btn-danger dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
							    		<i class="fas fa-check-double"></i><span class="pl-3">Actions ...</span> 
							  		</button>
							  		
							  		<div class="dropdown-menu">
									    <a class="dropdown-item delete-selected-items" href="#">
									    	<i class="fas fa-trash-alt"></i><span class="pl-3">Delete selected products</span></a>
									    <a class="dropdown-item delete-all" href="#">
									    	<i class="fas fa-recycle"></i><span class="pl-3">Delete all products</span></a>
							  		</div>
								</div>
							</div>	 
                        </div>
                    </div>
                    
                    <!-- Modal box containing form for new products -->
                    
					<div>
						<div id="new-product-form" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="new-product-form-label" aria-hidden="true">
						  <div class="modal-dialog modal-dialog-scrollable" role="document">
						    <div class="modal-content">
						    
						      <div class="modal-header">
						        <h5 class="modal-title" id="new-product-form-label"><i class="fas fa-plus"></i><span class="pl-3">Add Product</span></h5>
						        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
						          <span aria-hidden="true">&times;</span>
						        </button>
						      </div>
						      <!-- /.modal-header -->
						      
						      <div class="modal-body">		
						      
						      	<!-- Form for adding new product -->	
						      				        	
					        	<form class="needs-validation" novalidate method="post" th:action="@{/manage/products/add}" id="form-add-product">
								  	
								  	<div class="alert alert-danger alert-dismissible fade hidden" role="alert">
									  <span class="alert-message"></span>
									  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
									    <span aria-hidden="true">&times;</span>
									  </button>
									</div>
									
									<div class="form-group">
									  	<label class="col-form-label" for="code">Code</label>
									  	<input name="code" type="text" class="form-control alz-ctr" id="code" placeholder="Product unique code" required>
										<div class="invalid-feedback">Product unique code is required</div>
									</div>
									
									<div class="form-group">
									  	<label class="col-form-label" for="name">Name</label>
									  	<input name="name" type="text" class="form-control alz-ctr" id="name" placeholder="Product name" required>
								  		<div class="invalid-feedback">Product name is required</div>
								  	</div>
								  	
									<div class="form-group">
									  	<label class="col-form-label" for="brand">Brand</label>
									  	<input name="brand" type="text" class="form-control alz-ctr" id="brand" placeholder="Brand">
									</div>
									
									<div class="form-group">
										<label class="col-form-label" for="unitPrice">Unit Price</label>
									  	<input name="unitPrice" type="number" class="form-control alz-ctr" id="unitPrice" required>	
									  	<div class="invalid-feedback">Product unit price is required</div>
								  	</div>
								  	
									<div class="form-group">
									  	<label class="col-form-label" for="quantity">Quantity</label>
									  	<input name="quantity" type="number" class="form-control alz-ctr" id="quantity" placeholder="Quantity available">
								  	</div>
								  	
									<div class="form-group">
									  	<label class="col-form-label" for="views">Views</label>
									  	<input name="views" type="number" class="form-control alz-ctr" id="views">
								  	</div>
								  	
									<div class="form-group">
									  	<label class="col-form-label" for="purchases">Purchases</label>
									  	<input name="purchases" type="number" class="form-control alz-ctr" id="purchases">
								  	</div>
								  	
									<div class="form-group">
										<label for="category" class="col-form-label">Category<span class="pl-3"><button class="btn btn-sm btn-warning" id="add-category">New Category</button></span></label>
									  	<select class="form-control alz-ctr" id="category" name="category" required>
									  		<option>Select a category ....</option>
									  		<option th:each="cat : ${categories}" th:value="${cat.categoryId}" th:text="${cat.name}"></option>
									  	</select>	
									  	<div class="invalid-feedback">Select a valid product category</div>								  	
								  	</div>
								  	
									<div class="form-group">
										<label for="supplier" class="col-form-label">Supplier<span class="pl-3"><button class="btn btn-sm btn-warning" id="add-suppier">New Supplier</button></span></label>
									  	<select class="form-control alz-ctr" id="supplier" name="supplier">
									  		<option>Select a supplier ...</option>
									  		<option th:each="supplier : ${suppliers}" th:value="${supplier.supplierId}" th:text="${supplier.name}"></option>
									  	</select>
									  	<div class="invalid-feedback">Select a valid product supplier</div>										  	
								  	</div>
								  	
								  	<div class="custom-file">
									  <input name="image" type="file" class="custom-file-input" id="image" required>
									  <label data-browse="Choose Product image" class="custom-file-label" for="image">Choose file</label>
									  <div class="invalid-feedback">Select a valid product image</div>	
									</div>
								  	
									<div class="form-group">
								  		<label class="col-form-label" for="description">Description</label>									  	
								  		<textarea id="description" class="form-control" rows="" cols="" name="description"></textarea>										
									</div>
								</form>
						      </div>
						      <!-- /.modal-body -->
						      
						      <div class="modal-footer">
						        <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fas fa-times-circle"></i><span class="pl-3">Close</span></button>
						        <button id="save-client-btn" type="button" class="btn btn-info"><i class="fas fa-check"></i><span class="pl-3">Save changes</span></button>
						      </div>
						      <!-- /.modal-body -->
						      
						    </div>
						  </div>
						</div>
					</div>
                </div>
                                
                <div class="col-md-12">
					<div class="card-header">
                   		<i class="fas fa-list"></i><span class="pl-3">Products list</span>
                   	</div>
                       
                       <div class="card-body">
                           <table class="table table-striped table-bordered" id="listproducts">
								<thead>
									<tr>
										<th></th>
										<th></th>
										<th>Name</th>
										<th>Brand</th>
										<th>Price</th>
										<th>Quantity</th>
										<th>Code</th>
										<th>Active</th>
										<th>Action</th>
									</tr>
								</thead>
								
								<tbody>
									<tr th:each="prod : ${products}">
										<td>
						    				<input type="checkbox" class="alz-selected" th:value="${prod.productId}" />
						    			</td>
										<td>
											 <a th:href="@{'/product/' + ${prod.productId} + '/show'}">
											 	<img alt="" th:src="@{/assets/img/phone.jpg}" class="img-thumbnail img-small" />
											</a>
										</td>
										<td class="align-middle" th:text="${prod.name}"></td>
										<td class="align-middle" th:text="${prod.brand}"></td>
										<td class="align-middle" th:text="${#numbers.formatDecimal({prod.unitPrice}, 3, 'WHITESPACE', 2, 'DEFAULT')}"></td>
										<td class="align-middle" th:classappend="${prod.quantity > 0} ? '' : 'text-danger'" th:text="${prod.quantity > 0} ? ${prod.quantity} : 'Out of stock'"></td>
										<td class="align-middle" th:text="${prod.code}"></td>
										<td class="align-middle">
											<input type="checkbox" class="alz-selected" th:value="${prod.productId}" th:checked="${prod.isActive}"/>
										</td>
										<td class="align-middle">
											<div class="dropdown">
											  <button class="btn btn-info dropdown-toggle" type="button" th:id="${'dropdownMenuBtn' + prod.productId}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
											    <i class="fas fa-list"></i><span class="pl-3">Action</span> 
											  </button>
											  <div class="dropdown-menu" th:aria-labelledby="${'dropdownMenuBtn' + prod.productId}">
											    <a class="dropdown-item" th:href="@{'/product/' + ${prod.productId} + '/show'}"><i class="fas fa-eye"></i><span class="pl-3">View</span></a>
											    <div class="dropdown-divider"></div>
											    <a class="dropdown-item" th:classappend="${prod.quantity > 0} ? '' : 'disabled '" th:href="@{'/cart/add/' + ${prod.productId} + '/product'}"><i class="fas fa-cart-plus"></i><span class="pl-3">Add to cart</span></a>
											  </div>
											</div>					
										</td>
									</tr>			
								</tbody>
								<tfoot>
									<tr>
										<th>Name</th>
										<th>Brand</th>
										<th>Price</th>
										<th>Quantity</th>
										<th>Code</th>
										<th>Action</th>
									</tr>
								</tfoot>
							</table>
                       </div>						
				</div>
            </div>
	</div>

</body>
</html>